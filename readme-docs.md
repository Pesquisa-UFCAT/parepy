# 3. How to build the documentation locally using Sphinx

### 3.1 Initialize the Sphinx project

From the root of your project (where the `metapy_toolbox` folder is located):

```bash
sphinx-quickstart docs
```

* `docs` will be the folder where your documentation is stored.
* Important `quickstart` questions:

  * **Separate source and build directories**: `yes`
  * **Project name**: enter `metapy_toolbox`
  * **Author**: your name
  * **Python modules**: `yes`

This creates a structure like:

```
docs/
 ├─ source/
 │   ├─ conf.py
 │   ├─ index.rst
 └─ build/
```

## Configure `conf.py`

Open `docs/source/conf.py` and add at the top of the file:

```python
import os
import sys
sys.path.insert(0, os.path.abspath('../../'))
```

* The `sys.path.insert` allows Sphinx to find your modules.

Next, locate the `extensions` section and modify it to include:

```python
extensions = [
    'sphinx.ext.autodoc',
    'sphinx.ext.napoleon',         # Support for Google/NumPy docstrings
    'sphinx_autodoc_typehints',    # Python types in docstrings
]

add_module_names = False
autodoc_typehints = "description"
```

Finally, set the HTML theme to `sphinx_rtd_theme`:

```python
html_theme = 'sphinx_rtd_theme'
```

## Create `.rst` files for each module

You can create `.rst` files manually or automatically using `sphinx-apidoc`:

```bash
sphinx-apidoc -o "docs/source" "full_path_to_metapy_toolbox"
```

This will generate `.rst` files for each `.py` file inside `metapy_toolbox`.

## Reference the modules in `index.rst`

In `docs/source/index.rst`, reference the modules generated by `sphinx-apidoc`. You only need to reference the `modules.rst` file that `sphinx-apidoc` created:

```rst
Welcome to metapy_toolbox's documentation!
==========================================

.. toctree::
   :maxdepth: 2
   :caption: Contents:

   modules   

Indices and tables
==================

* :ref:`genindex`   
* :ref:`modindex`   
* :ref:`search`    
```

> If you want to add more `.rst` files manually, add the file name (without the `.rst` extension) in the `toctree` section.

## Build the documentation

Make sure your terminal is in the `docs` folder and run:

```bash
sphinx-build -b html source build/html
```

* The compiled documentation will be in `docs/build/html/index.html`.
* Open it in a browser to view.


# 4. Publishing the documentation on GitHub Pages

To publish the documentation generated by Sphinx:

1. Make sure you have built the HTML files with Sphinx. The output will be inside the `build/html` folder.
2. Copy **all content from the `html` folder** (HTML files, `_static/`, `_sources/`, etc.) into the `docs/` folder on the `gh-pages` branch.
3. In the root of the `docs/` folder, create an empty file named `.nojekyll`. This ensures GitHub Pages serves folders starting with `_` (like `_static`) correctly without processing them with Jekyll.
4. Commit and push the changes to the `gh-pages` branch.

After this, GitHub Pages will serve the documentation correctly, including the Sphinx theme and scripts.